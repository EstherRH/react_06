{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.handleClientScriptLoad = handleClientScriptLoad;\nexports.initScriptLoader = initScriptLoader;\nexports.default = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _headManagerContext = require(\"../shared/lib/head-manager-context\");\n\nvar _headManager = require(\"./head-manager\");\n\nvar _requestIdleCallback = require(\"./request-idle-callback\");\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\n          var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n\n          if (desc.get || desc.set) {\n            Object.defineProperty(newObj, key, desc);\n          } else {\n            newObj[key] = obj[key];\n          }\n        }\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === \"function\") {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nconst ScriptCache = new Map();\nconst LoadCache = new Set();\nconst ignoreProps = ['onLoad', 'dangerouslySetInnerHTML', 'children', 'onError', 'strategy'];\n\nconst loadScript = props => {\n  const {\n    src,\n    id,\n    onLoad = () => {},\n    dangerouslySetInnerHTML,\n    children = '',\n    strategy = 'afterInteractive',\n    onError\n  } = props;\n  const cacheKey = id || src; // Script has already loaded\n\n  if (cacheKey && LoadCache.has(cacheKey)) {\n    return;\n  } // Contents of this script are already loading/loaded\n\n\n  if (ScriptCache.has(src)) {\n    LoadCache.add(cacheKey); // Execute onLoad since the script loading has begun\n\n    ScriptCache.get(src).then(onLoad, onError);\n    return;\n  }\n\n  const el = document.createElement('script');\n  const loadPromise = new Promise((resolve, reject) => {\n    el.addEventListener('load', function (e) {\n      resolve();\n\n      if (onLoad) {\n        onLoad.call(this, e);\n      }\n    });\n    el.addEventListener('error', function (e) {\n      reject(e);\n    });\n  }).catch(function (e) {\n    if (onError) {\n      onError(e);\n    }\n  });\n\n  if (src) {\n    ScriptCache.set(src, loadPromise);\n  }\n\n  LoadCache.add(cacheKey);\n\n  if (dangerouslySetInnerHTML) {\n    el.innerHTML = dangerouslySetInnerHTML.__html || '';\n  } else if (children) {\n    el.textContent = typeof children === 'string' ? children : Array.isArray(children) ? children.join('') : '';\n  } else if (src) {\n    el.src = src;\n  }\n\n  for (const [k, value] of Object.entries(props)) {\n    if (value === undefined || ignoreProps.includes(k)) {\n      continue;\n    }\n\n    const attr = _headManager.DOMAttributeNames[k] || k.toLowerCase();\n    el.setAttribute(attr, value);\n  }\n\n  if (strategy === 'worker') {\n    el.setAttribute('type', 'text/partytown');\n  }\n\n  el.setAttribute('data-nscript', strategy);\n  document.body.appendChild(el);\n};\n\nfunction handleClientScriptLoad(props) {\n  const {\n    strategy = 'afterInteractive'\n  } = props;\n\n  if (strategy === 'lazyOnload') {\n    window.addEventListener('load', () => {\n      (0, _requestIdleCallback).requestIdleCallback(() => loadScript(props));\n    });\n  } else {\n    loadScript(props);\n  }\n}\n\nfunction loadLazyScript(props) {\n  if (document.readyState === 'complete') {\n    (0, _requestIdleCallback).requestIdleCallback(() => loadScript(props));\n  } else {\n    window.addEventListener('load', () => {\n      (0, _requestIdleCallback).requestIdleCallback(() => loadScript(props));\n    });\n  }\n}\n\nfunction addBeforeInteractiveToCache() {\n  const scripts = [...document.querySelectorAll('[data-nscript=\"beforeInteractive\"]'), ...document.querySelectorAll('[data-nscript=\"beforePageRender\"]')];\n  scripts.forEach(script => {\n    const cacheKey = script.id || script.getAttribute('src');\n    LoadCache.add(cacheKey);\n  });\n}\n\nfunction initScriptLoader(scriptLoaderItems) {\n  scriptLoaderItems.forEach(handleClientScriptLoad);\n  addBeforeInteractiveToCache();\n}\n\nfunction Script(props) {\n  const {\n    src = '',\n    onLoad = () => {},\n    strategy = 'afterInteractive',\n    onError\n  } = props,\n        restProps = _objectWithoutProperties(props, [\"src\", \"onLoad\", \"strategy\", \"onError\"]); // Context is available only during SSR\n\n\n  const {\n    updateScripts,\n    scripts,\n    getIsSsr\n  } = (0, _react).useContext(_headManagerContext.HeadManagerContext);\n  (0, _react).useEffect(() => {\n    if (strategy === 'afterInteractive') {\n      loadScript(props);\n    } else if (strategy === 'lazyOnload') {\n      loadLazyScript(props);\n    }\n  }, [props, strategy]);\n\n  if (strategy === 'beforeInteractive' || strategy === 'worker') {\n    if (updateScripts) {\n      scripts[strategy] = (scripts[strategy] || []).concat([_objectSpread({\n        src,\n        onLoad,\n        onError\n      }, restProps)]);\n      updateScripts(scripts);\n    } else if (getIsSsr && getIsSsr()) {\n      // Script has already loaded during SSR\n      LoadCache.add(restProps.id || src);\n    } else if (getIsSsr && !getIsSsr()) {\n      loadScript(props);\n    }\n  }\n\n  return null;\n}\n\nvar _default = Script;\nexports.default = _default;\n\nif (typeof exports.default === 'function' || typeof exports.default === 'object' && exports.default !== null) {\n  Object.assign(exports.default, exports);\n  module.exports = exports.default;\n}","map":{"version":3,"sources":["../../client/script.tsx"],"names":["ScriptCache","Map","LoadCache","Set","ignoreProps","loadScript","props","src","id","onLoad","dangerouslySetInnerHTML","children","strategy","onError","cacheKey","has","add","get","then","el","document","createElement","loadPromise","Promise","resolve","reject","addEventListener","e","call","catch","set","innerHTML","__html","textContent","Array","isArray","join","k","value","Object","entries","undefined","includes","attr","DOMAttributeNames","toLowerCase","setAttribute","body","appendChild","handleClientScriptLoad","window","requestIdleCallback","loadLazyScript","readyState","addBeforeInteractiveToCache","scripts","querySelectorAll","forEach","script","getAttribute","initScriptLoader","scriptLoaderItems","Script","restProps","updateScripts","getIsSsr","useContext","HeadManagerContext","useEffect","concat"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.handleClientScriptLoad = handleClientScriptLoad;\nexports.initScriptLoader = initScriptLoader;\nexports.default = void 0;\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _headManagerContext = require(\"../shared/lib/head-manager-context\");\nvar _headManager = require(\"./head-manager\");\nvar _requestIdleCallback = require(\"./request-idle-callback\");\nfunction _defineProperty(obj, key, value) {\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true\n        });\n    } else {\n        obj[key] = value;\n    }\n    return obj;\n}\nfunction _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n        return obj;\n    } else {\n        var newObj = {};\n        if (obj != null) {\n            for(var key in obj){\n                if (Object.prototype.hasOwnProperty.call(obj, key)) {\n                    var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n                    if (desc.get || desc.set) {\n                        Object.defineProperty(newObj, key, desc);\n                    } else {\n                        newObj[key] = obj[key];\n                    }\n                }\n            }\n        }\n        newObj.default = obj;\n        return newObj;\n    }\n}\nfunction _objectSpread(target) {\n    for(var i = 1; i < arguments.length; i++){\n        var source = arguments[i] != null ? arguments[i] : {};\n        var ownKeys = Object.keys(source);\n        if (typeof Object.getOwnPropertySymbols === \"function\") {\n            ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym) {\n                return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n            }));\n        }\n        ownKeys.forEach(function(key) {\n            _defineProperty(target, key, source[key]);\n        });\n    }\n    return target;\n}\nfunction _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n    var key, i;\n    if (Object.getOwnPropertySymbols) {\n        var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n        for(i = 0; i < sourceSymbolKeys.length; i++){\n            key = sourceSymbolKeys[i];\n            if (excluded.indexOf(key) >= 0) continue;\n            if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n            target[key] = source[key];\n        }\n    }\n    return target;\n}\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n    for(i = 0; i < sourceKeys.length; i++){\n        key = sourceKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        target[key] = source[key];\n    }\n    return target;\n}\nconst ScriptCache = new Map();\nconst LoadCache = new Set();\nconst ignoreProps = [\n    'onLoad',\n    'dangerouslySetInnerHTML',\n    'children',\n    'onError',\n    'strategy', \n];\nconst loadScript = (props)=>{\n    const { src , id , onLoad =()=>{} , dangerouslySetInnerHTML , children ='' , strategy ='afterInteractive' , onError ,  } = props;\n    const cacheKey = id || src;\n    // Script has already loaded\n    if (cacheKey && LoadCache.has(cacheKey)) {\n        return;\n    }\n    // Contents of this script are already loading/loaded\n    if (ScriptCache.has(src)) {\n        LoadCache.add(cacheKey);\n        // Execute onLoad since the script loading has begun\n        ScriptCache.get(src).then(onLoad, onError);\n        return;\n    }\n    const el = document.createElement('script');\n    const loadPromise = new Promise((resolve, reject)=>{\n        el.addEventListener('load', function(e) {\n            resolve();\n            if (onLoad) {\n                onLoad.call(this, e);\n            }\n        });\n        el.addEventListener('error', function(e) {\n            reject(e);\n        });\n    }).catch(function(e) {\n        if (onError) {\n            onError(e);\n        }\n    });\n    if (src) {\n        ScriptCache.set(src, loadPromise);\n    }\n    LoadCache.add(cacheKey);\n    if (dangerouslySetInnerHTML) {\n        el.innerHTML = dangerouslySetInnerHTML.__html || '';\n    } else if (children) {\n        el.textContent = typeof children === 'string' ? children : Array.isArray(children) ? children.join('') : '';\n    } else if (src) {\n        el.src = src;\n    }\n    for (const [k, value] of Object.entries(props)){\n        if (value === undefined || ignoreProps.includes(k)) {\n            continue;\n        }\n        const attr = _headManager.DOMAttributeNames[k] || k.toLowerCase();\n        el.setAttribute(attr, value);\n    }\n    if (strategy === 'worker') {\n        el.setAttribute('type', 'text/partytown');\n    }\n    el.setAttribute('data-nscript', strategy);\n    document.body.appendChild(el);\n};\nfunction handleClientScriptLoad(props) {\n    const { strategy ='afterInteractive'  } = props;\n    if (strategy === 'lazyOnload') {\n        window.addEventListener('load', ()=>{\n            (0, _requestIdleCallback).requestIdleCallback(()=>loadScript(props)\n            );\n        });\n    } else {\n        loadScript(props);\n    }\n}\nfunction loadLazyScript(props) {\n    if (document.readyState === 'complete') {\n        (0, _requestIdleCallback).requestIdleCallback(()=>loadScript(props)\n        );\n    } else {\n        window.addEventListener('load', ()=>{\n            (0, _requestIdleCallback).requestIdleCallback(()=>loadScript(props)\n            );\n        });\n    }\n}\nfunction addBeforeInteractiveToCache() {\n    const scripts = [\n        ...document.querySelectorAll('[data-nscript=\"beforeInteractive\"]'),\n        ...document.querySelectorAll('[data-nscript=\"beforePageRender\"]'), \n    ];\n    scripts.forEach((script)=>{\n        const cacheKey = script.id || script.getAttribute('src');\n        LoadCache.add(cacheKey);\n    });\n}\nfunction initScriptLoader(scriptLoaderItems) {\n    scriptLoaderItems.forEach(handleClientScriptLoad);\n    addBeforeInteractiveToCache();\n}\nfunction Script(props) {\n    const { src ='' , onLoad =()=>{} , strategy ='afterInteractive' , onError  } = props, restProps = _objectWithoutProperties(props, [\n        \"src\",\n        \"onLoad\",\n        \"strategy\",\n        \"onError\"\n    ]);\n    // Context is available only during SSR\n    const { updateScripts , scripts , getIsSsr  } = (0, _react).useContext(_headManagerContext.HeadManagerContext);\n    (0, _react).useEffect(()=>{\n        if (strategy === 'afterInteractive') {\n            loadScript(props);\n        } else if (strategy === 'lazyOnload') {\n            loadLazyScript(props);\n        }\n    }, [\n        props,\n        strategy\n    ]);\n    if (strategy === 'beforeInteractive' || strategy === 'worker') {\n        if (updateScripts) {\n            scripts[strategy] = (scripts[strategy] || []).concat([\n                _objectSpread({\n                    src,\n                    onLoad,\n                    onError\n                }, restProps), \n            ]);\n            updateScripts(scripts);\n        } else if (getIsSsr && getIsSsr()) {\n            // Script has already loaded during SSR\n            LoadCache.add(restProps.id || src);\n        } else if (getIsSsr && !getIsSsr()) {\n            loadScript(props);\n        }\n    }\n    return null;\n}\nvar _default = Script;\nexports.default = _default;\n\nif (typeof exports.default === 'function' || (typeof exports.default === 'object' && exports.default !== null)) {\n  Object.assign(exports.default, exports);\n  module.exports = exports.default;\n}\n\n//# sourceMappingURL=script.js.map"]},"metadata":{},"sourceType":"script"}